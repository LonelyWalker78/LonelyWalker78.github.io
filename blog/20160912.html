<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>js中浮点数与整数的比较以及加减运算</title>
		<link rel="stylesheet" type="text/css" href="../css/article.css">
	</head>
	<body>
		<div class="content">
			<div class="article">
				<h1>js中浮点数与整数的比较以及加减运算</h1>
				<section>
					<h3>前言</h3>
					<p>js是一种弱类型语言，并不像java、C#等语言有各种各样的数据类型，js的基本数据类型只有五种：Undefined、Null、Boolean、Number、String。但是做web开发时难免会遇到浮点数的使用，这时我们需要对浮点数进行一些处理以便能够得到我们需要的结果。</p>
					<h3>一、传值</h3>
					<p>举个例子，用户在发布商品时需要在输入框中填入价格，但是将数据提交到服务器是在另外一个页面，这时我们需要先把价格存储起来（var price = document.getElementById('price').value;）然后传到另外那个页面再提交上传到后台服务器，然而价格一般都是带有两位小数的，如果直接将price这个变量的值上传到服务器的话就可能会有问题。</p>
					<p>所以我们需要借助“隐藏域”&lt;input id="price" type="hidden"/&gt;，将数据放在input中，上传时直接将input的value值上传即可。</p>
					<h3>二、比较大小</h3>
					<p>在上一点中提到说借助隐藏域进行浮点数的传值，然而隐藏域并不是万能的。当我们进行浮点数与数字的大小判断时，借助隐藏域存储浮点数再与数字进行判断会有问题（价格依次为3、5、7，积分为10-29之间js无法判断积分大于价格）；这时使用parseFloat(price)来与数字积分进行判断即可正确判断。</p>
					<h3>三、加减法</h3>
					<p>废话不多说，直接上代码：</p>
					<div class="lcj-code"><span class="sc42">/*加法函数，用来得到精确的加法结果*/</span><span class="sc41">
</span><span class="sc47">function</span><span class="sc41"> </span><span class="sc46">addition</span><span class="sc50">(</span><span class="sc46">arg1</span><span class="sc50">,</span><span class="sc41"> </span><span class="sc46">arg2</span><span class="sc50">)</span><span class="sc41"> </span><span class="sc50">{</span><span class="sc41">
    </span><span class="sc47">var</span><span class="sc41"> </span><span class="sc46">r1</span><span class="sc50">,</span><span class="sc41"> </span><span class="sc46">r2</span><span class="sc50">,</span><span class="sc41"> </span><span class="sc46">m</span><span class="sc50">,</span><span class="sc41"> </span><span class="sc46">n</span><span class="sc50">;</span><span class="sc41">
    </span><span class="sc47">try</span><span class="sc41"> </span><span class="sc50">{</span><span class="sc41">
        </span><span class="sc46">r1</span><span class="sc41"> </span><span class="sc50">=</span><span class="sc41"> </span><span class="sc46">arg1.toString</span><span class="sc50">().</span><span class="sc46">split</span><span class="sc50">(</span><span class="sc48">"."</span><span class="sc50">)[</span><span class="sc45">1</span><span class="sc50">].</span><span class="sc46">length</span><span class="sc50">;</span><span class="sc41">
    </span><span class="sc50">}</span><span class="sc41"> </span><span class="sc47">catch</span><span class="sc50">(</span><span class="sc46">e</span><span class="sc50">)</span><span class="sc41"> </span><span class="sc50">{</span><span class="sc41">
        </span><span class="sc46">r1</span><span class="sc41"> </span><span class="sc50">=</span><span class="sc41"> </span><span class="sc45">0</span><span class="sc50">;</span><span class="sc41">
    </span><span class="sc50">}</span><span class="sc41">
    </span><span class="sc47">try</span><span class="sc41"> </span><span class="sc50">{</span><span class="sc41">
        </span><span class="sc46">r2</span><span class="sc41"> </span><span class="sc50">=</span><span class="sc41"> </span><span class="sc46">arg2.toString</span><span class="sc50">().</span><span class="sc46">split</span><span class="sc50">(</span><span class="sc48">"."</span><span class="sc50">)[</span><span class="sc45">1</span><span class="sc50">].</span><span class="sc46">length</span><span class="sc50">;</span><span class="sc41">
    </span><span class="sc50">}</span><span class="sc41"> </span><span class="sc47">catch</span><span class="sc50">(</span><span class="sc46">e</span><span class="sc50">)</span><span class="sc41"> </span><span class="sc50">{</span><span class="sc41">
        </span><span class="sc46">r2</span><span class="sc41"> </span><span class="sc50">=</span><span class="sc41"> </span><span class="sc45">0</span><span class="sc50">;</span><span class="sc41">
    </span><span class="sc50">}</span><span class="sc41">
    </span><span class="sc46">m</span><span class="sc41"> </span><span class="sc50">=</span><span class="sc41"> </span><span class="sc46">Math.pow</span><span class="sc50">(</span><span class="sc45">10</span><span class="sc50">,</span><span class="sc41"> </span><span class="sc46">Math.max</span><span class="sc50">(</span><span class="sc46">r1</span><span class="sc50">,</span><span class="sc41"> </span><span class="sc46">r2</span><span class="sc50">));</span><span class="sc41"> </span><span class="sc43">//last modify by deeka //动态控制精度长度</span><span class="sc41">
    </span><span class="sc46">n</span><span class="sc41"> </span><span class="sc50">=</span><span class="sc41"> </span><span class="sc50">(</span><span class="sc46">r1</span><span class="sc41"> </span><span class="sc50">&gt;=</span><span class="sc41"> </span><span class="sc46">r2</span><span class="sc50">)</span><span class="sc41"> </span><span class="sc50">?</span><span class="sc41"> </span><span class="sc46">r1</span><span class="sc41"> </span><span class="sc50">:</span><span class="sc41"> </span><span class="sc46">r2</span><span class="sc50">;</span><span class="sc41">
    </span><span class="sc47">return</span><span class="sc50">((</span><span class="sc46">arg1</span><span class="sc41"> </span><span class="sc50">*</span><span class="sc41"> </span><span class="sc46">m</span><span class="sc41"> </span><span class="sc50">+</span><span class="sc41"> </span><span class="sc46">arg2</span><span class="sc41"> </span><span class="sc50">*</span><span class="sc41"> </span><span class="sc46">m</span><span class="sc50">)</span><span class="sc41"> </span><span class="sc50">/</span><span class="sc41"> </span><span class="sc46">m</span><span class="sc50">).</span><span class="sc46">toFixed</span><span class="sc50">(</span><span class="sc46">n</span><span class="sc50">);</span><span class="sc41">
</span><span class="sc50">};</span></div>
					<div class="lcj-code"><span class="sc42">/*减法函数，用来得到精确的减法结果*/</span><span class="sc41">
</span><span class="sc47">function</span><span class="sc41"> </span><span class="sc46">accSub</span><span class="sc50">(</span><span class="sc46">arg1</span><span class="sc50">,</span><span class="sc41"> </span><span class="sc46">arg2</span><span class="sc50">)</span><span class="sc41"> </span><span class="sc50">{</span><span class="sc41">
    </span><span class="sc47">var</span><span class="sc41"> </span><span class="sc46">r1</span><span class="sc50">,</span><span class="sc41"> </span><span class="sc46">r2</span><span class="sc50">,</span><span class="sc41"> </span><span class="sc46">m</span><span class="sc50">,</span><span class="sc41"> </span><span class="sc46">n</span><span class="sc50">;</span><span class="sc41">
    </span><span class="sc47">try</span><span class="sc41"> </span><span class="sc50">{</span><span class="sc41">
        </span><span class="sc46">r1</span><span class="sc41"> </span><span class="sc50">=</span><span class="sc41"> </span><span class="sc46">arg1.toString</span><span class="sc50">().</span><span class="sc46">split</span><span class="sc50">(</span><span class="sc48">"."</span><span class="sc50">)[</span><span class="sc45">1</span><span class="sc50">].</span><span class="sc46">length</span><span class="sc50">;</span><span class="sc41">
    </span><span class="sc50">}</span><span class="sc41">
    </span><span class="sc47">catch</span><span class="sc41"> </span><span class="sc50">(</span><span class="sc46">e</span><span class="sc50">)</span><span class="sc41"> </span><span class="sc50">{</span><span class="sc41">
        </span><span class="sc46">r1</span><span class="sc41"> </span><span class="sc50">=</span><span class="sc41"> </span><span class="sc45">0</span><span class="sc50">;</span><span class="sc41">
    </span><span class="sc50">}</span><span class="sc41">
    </span><span class="sc47">try</span><span class="sc41"> </span><span class="sc50">{</span><span class="sc41">
        </span><span class="sc46">r2</span><span class="sc41"> </span><span class="sc50">=</span><span class="sc41"> </span><span class="sc46">arg2.toString</span><span class="sc50">().</span><span class="sc46">split</span><span class="sc50">(</span><span class="sc48">"."</span><span class="sc50">)[</span><span class="sc45">1</span><span class="sc50">].</span><span class="sc46">length</span><span class="sc50">;</span><span class="sc41">
    </span><span class="sc50">}</span><span class="sc41">
    </span><span class="sc47">catch</span><span class="sc41"> </span><span class="sc50">(</span><span class="sc46">e</span><span class="sc50">)</span><span class="sc41"> </span><span class="sc50">{</span><span class="sc41">
        </span><span class="sc46">r2</span><span class="sc41"> </span><span class="sc50">=</span><span class="sc41"> </span><span class="sc45">0</span><span class="sc50">;</span><span class="sc41">
    </span><span class="sc50">}</span><span class="sc41">
    </span><span class="sc46">m</span><span class="sc41"> </span><span class="sc50">=</span><span class="sc41"> </span><span class="sc46">Math.pow</span><span class="sc50">(</span><span class="sc45">10</span><span class="sc50">,</span><span class="sc41"> </span><span class="sc46">Math.max</span><span class="sc50">(</span><span class="sc46">r1</span><span class="sc50">,</span><span class="sc41"> </span><span class="sc46">r2</span><span class="sc50">));</span><span class="sc41"> </span><span class="sc43">//last modify by deeka //动态控制精度长度</span><span class="sc41">
    </span><span class="sc46">n</span><span class="sc41"> </span><span class="sc50">=</span><span class="sc41"> </span><span class="sc50">(</span><span class="sc46">r1</span><span class="sc41"> </span><span class="sc50">&gt;=</span><span class="sc41"> </span><span class="sc46">r2</span><span class="sc50">)</span><span class="sc41"> </span><span class="sc50">?</span><span class="sc41"> </span><span class="sc46">r1</span><span class="sc41"> </span><span class="sc50">:</span><span class="sc41"> </span><span class="sc46">r2</span><span class="sc50">;</span><span class="sc41">
    </span><span class="sc47">return</span><span class="sc41"> </span><span class="sc50">((</span><span class="sc46">arg1</span><span class="sc41"> </span><span class="sc50">*</span><span class="sc41"> </span><span class="sc46">m</span><span class="sc41"> </span><span class="sc50">-</span><span class="sc41"> </span><span class="sc46">arg2</span><span class="sc41"> </span><span class="sc50">*</span><span class="sc41"> </span><span class="sc46">m</span><span class="sc50">)</span><span class="sc41"> </span><span class="sc50">/</span><span class="sc41"> </span><span class="sc46">m</span><span class="sc50">).</span><span class="sc46">toFixed</span><span class="sc50">(</span><span class="sc46">n</span><span class="sc50">);</span><span class="sc41">
</span><span class="sc50">};</span></div>
					<p>可以看出，加法与减法两个函数其实就在于最后一句return((arg1 * m + arg2 * m) / m).toFixed(n);中加号与减号的差别而已，函数返回值的小数点后面的位数等于你传入的两个参数中，小数点位数最多的。</p>
				</section>
			</div>
		</div>
	</body>
</html>